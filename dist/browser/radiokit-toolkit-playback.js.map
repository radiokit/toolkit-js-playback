{"version":3,"sources":["webpack:///webpack/bootstrap 01da0f21a4120c0019ec","webpack:///./lib/index.js","webpack:///(webpack)/buildin/module.js","webpack:///./lib/channel/Player.js","webpack:///./lib/Base.js","webpack:///./lib/clock/SyncClock.js","webpack:///./lib/channel/Playlist.js","webpack:///./lib/channel/Track.js","webpack:///./lib/audio/AudioManager.js","webpack:///./lib/audio/Factory.ts","webpack:///./lib/audio/WebAudioPlayer.js","webpack:///./lib/audio/HTMLPlayer.ts","webpack:///./lib/audio/Source.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACTA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,EAAC;AACD;;;;;;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACpBA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAgF;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,wCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACvEA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;;ACtCA,4CAA+B,CAAkB,CAAC;AAClD,wCAA2B,EAAc,CAAC;AAQ1C;KAAA;KAcA,CAAC;KARe,YAAI,GAAlB,UAAmB,MAAc;SAC/B,EAAE,EAAC,+BAAc,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;aAChC,MAAM,CAAC,IAAI,+BAAc,CAAC,MAAM,CAAC,CAAC;SAEpC,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,MAAM,CAAC,IAAI,uBAAU,CAAC,MAAM,CAAC,CAAC;SAChC,CAAC;KACH,CAAC;KACH,cAAC;AAAD,EAAC;AAdY,gBAAO,UAcnB;;;;;;;ACxBD;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;;AC1DA;KAGE,oBAAY,MAAc;SACxB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;KACvB,CAAC;KAGD,yBAAI,GAAJ;SACE,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGD,yBAAI,GAAJ;SACE,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KACH,iBAAC;AAAD,EAAC;AAhBY,mBAAU,aAgBtB;;;;;;;;ACzBD;KAKE,gBAAY,GAAW,EAAE,IAAY;SACnC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;SACf,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;KACnB,CAAC;KAGM,wBAAO,GAAd;SACE,MAAM,CAAC,IAAI,CAAC,IAAI;KAClB,CAAC;KAGM,uBAAM,GAAb;SACE,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC;KAClB,CAAC;KACH,aAAC;AAAD,EAAC;AAnBY,eAAM,SAmBlB","file":"radiokit-toolkit-playback.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 01da0f21a4120c0019ec","\"use strict\";\nvar Player_1 = require(\"./channel/Player\");\nvar e = {\n    Channel: {\n        Player: Player_1.Player,\n    }\n};\nmodule.e = e;\nif (typeof (window) !== \"undefined\") {\n    window['RadioKitToolkitPlayback'] = e;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/index.js\n// module id = 0\n// module chunks = 0","module.exports = function(module) {\n\tif(!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tmodule.children = [];\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar SyncClock_1 = require(\"../clock/SyncClock\");\nvar Playlist_1 = require(\"../channel/Playlist\");\nvar AudioManager_1 = require(\"../audio/AudioManager\");\nvar Player = (function (_super) {\n    __extends(Player, _super);\n    function Player(channelId, accessToken) {\n        var _this = _super.call(this) || this;\n        _this.__fetchTimeoutId = 0;\n        _this.__started = false;\n        _this.__channelId = channelId;\n        _this.__accessToken = accessToken;\n        _this.__audioManager = new AudioManager_1.AudioManager();\n        return _this;\n    }\n    Player.prototype.start = function () {\n        this.__startFetching();\n        this.__started = true;\n        return this;\n    };\n    Player.prototype.stop = function () {\n        this.__stopFetching();\n        this.__audioManager.cleanup();\n        this.__started = false;\n        return this;\n    };\n    Player.prototype._loggerTag = function () {\n        return this['constructor']['name'] + \" \" + this.__channelId;\n    };\n    Player.prototype.__startFetching = function () {\n        this.__fetchOnceAndRepeat();\n    };\n    Player.prototype.__stopFetching = function () {\n        if (this.__fetchTimeoutId !== 0) {\n            clearTimeout(this.__fetchTimeoutId);\n            this.__fetchTimeoutId = 0;\n        }\n    };\n    Player.prototype.__fetchOnce = function () {\n        var _this = this;\n        this.info(\"Fetch: Synchronizing clock...\");\n        var promise = new Promise(function (resolve, reject) {\n            SyncClock_1.SyncClock.makeAsync()\n                .catch(function (error) {\n                _this.warn(\"Fetch error: Unable to sync clock (\" + error.message + \")\");\n                reject(new Error(\"Unable to sync clock (\" + error.message + \")\"));\n            }).then(function (clock) {\n                _this.debug(\"Fetch: Synchronized clock\");\n                _this.debug(\"Fetch: Fetching playlist...\");\n                Playlist_1.Playlist.fetchAsync(_this.__channelId, _this.__accessToken, clock)\n                    .catch(function (error) {\n                    _this.warn(\"Fetch error: Unable to fetch playlist (\" + error.message + \")\");\n                    reject(new Error(\"Unable to fetch playlist (\" + error.message + \")\"));\n                })\n                    .then(function (playlist) {\n                    _this.debug(\"Fetch: Done\");\n                    if (_this.__started) {\n                        _this.__audioManager.update(playlist, clock);\n                    }\n                    resolve(playlist);\n                });\n            });\n        });\n        return promise;\n    };\n    Player.prototype.__fetchOnceAndRepeat = function () {\n        var _this = this;\n        this.__fetchOnce()\n            .catch(function (error) {\n            _this.__scheduleNextFetch();\n        })\n            .then(function (playlist) {\n            _this.__scheduleNextFetch();\n        });\n    };\n    Player.prototype.__scheduleNextFetch = function () {\n        var _this = this;\n        if (this.__started) {\n            var timeout = 2000 + Math.round(Math.random() * 250);\n            this.debug(\"Fetch: Scheduling next fetch in \" + timeout + \" ms\");\n            this.__fetchTimeoutId = setTimeout(function () {\n                _this.__fetchTimeoutId = 0;\n                _this.__fetchOnceAndRepeat();\n            }, timeout);\n        }\n    };\n    return Player;\n}(Base_1.Base));\nexports.Player = Player;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/channel/Player.js\n// module id = 2\n// module chunks = 0","\"use strict\";\nvar Base = (function () {\n    function Base() {\n        this.__events = {};\n    }\n    Base.prototype.on = function (eventName, callback) {\n    };\n    Base.prototype.off = function (eventName, callback) {\n    };\n    Base.prototype.warn = function (message) {\n        console.warn(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    Base.prototype.info = function (message) {\n        console.info(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    Base.prototype.debug = function (message) {\n        console.debug(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    return Base;\n}());\nexports.Base = Base;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/Base.js\n// module id = 3\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar SyncClock = (function (_super) {\n    __extends(SyncClock, _super);\n    function SyncClock(serverDate) {\n        var _this = _super.call(this) || this;\n        _this.__offset = serverDate - Date.now();\n        _this.debug(\"Constructed sync clock (offset = \" + _this.__offset + \" ms}\");\n        return _this;\n    }\n    SyncClock.makeAsync = function () {\n        var promise = new Promise(function (resolve, reject) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('OPTIONS', 'https://time.radiokitapp.org/api/time/v1.0/now', true);\n            xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n            xhr.timeout = 5000;\n            xhr.onerror = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Network error (\" + xhr.status + \")\"));\n            };\n            xhr.onabort = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Aborted\"));\n            };\n            xhr.ontimeout = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Timeout\"));\n            };\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(new SyncClock(Date.parse(JSON.parse(xhr.responseText).utc_time)));\n                    }\n                    else {\n                        reject(new Error(\"Unable to synchronize clock: Unexpected response (status = \" + xhr.status + \")\"));\n                    }\n                }\n            };\n            xhr.send();\n        });\n        return promise;\n    };\n    SyncClock.prototype.nowAsTimestamp = function () {\n        return Date.now() + this.__offset;\n    };\n    SyncClock.prototype._loggerTag = function () {\n        return this['constructor']['name'];\n    };\n    return SyncClock;\n}(Base_1.Base));\nexports.SyncClock = SyncClock;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/clock/SyncClock.js\n// module id = 4\n// module chunks = 0","\"use strict\";\nvar Track_1 = require(\"./Track\");\nvar Playlist = (function () {\n    function Playlist(tracks) {\n        this.__tracks = tracks;\n    }\n    Playlist.fetchAsync = function (channelId, accessToken, clock) {\n        var promise = new Promise(function (resolve, reject) {\n            var now = clock.nowAsTimestamp();\n            var xhr = new XMLHttpRequest();\n            var url = 'https://plumber.radiokitapp.org/api/rest/v1.0/media/input/file/radiokit/vault' +\n                '?a[]=id' +\n                '&a[]=name' +\n                '&a[]=file' +\n                '&a[]=cue_in_at' +\n                '&a[]=cue_out_at' +\n                '&a[]=cue_offset' +\n                '&a[]=fade_in_at' +\n                '&a[]=fade_out_at' +\n                '&s[]=cue%20' + encodeURIComponent(new Date(now).toISOString()) + '%2020%20600' +\n                '&c[references][]=deq%20broadcast_channel_id%20' + encodeURIComponent(channelId) +\n                '&o[]=cue_in_at%20asc';\n            xhr.open('GET', url, true);\n            xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n            xhr.setRequestHeader('Authorization', \"Bearer \" + accessToken);\n            xhr.timeout = 15000;\n            xhr.onerror = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Network error (\" + xhr.status + \")\"));\n            };\n            xhr.onabort = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Aborted\"));\n            };\n            xhr.ontimeout = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Timeout\"));\n            };\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        var responseAsJson = JSON.parse(xhr.responseText);\n                        resolve(Playlist.makeFromJson(responseAsJson[\"data\"]));\n                    }\n                    else {\n                        reject(new Error(\"Unable to fetch playlist: Unexpected response (status = \" + xhr.status + \")\"));\n                    }\n                }\n            };\n            xhr.send();\n        });\n        return promise;\n    };\n    Playlist.makeFromJson = function (data) {\n        var tracks = {};\n        for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n            var record = data_1[_i];\n            var id = record['id'];\n            var fileId = record['file'];\n            var cueInAt = new Date(record['cue_in_at']);\n            var cueOutAt = new Date(record['cue_out_at']);\n            var cueOffset = record['cue_offset'];\n            var fadeInAt = record['fade_in_at'] !== null ? new Date(record['fade_in_at']) : null;\n            var fadeOutAt = record['fade_out_at'] !== null ? new Date(record['fade_out_at']) : null;\n            var track = new Track_1.Track(id, fileId, cueInAt, cueOutAt, cueOffset, fadeInAt, fadeOutAt);\n            tracks[id] = track;\n        }\n        return new Playlist(tracks);\n    };\n    Playlist.prototype.getTracks = function () {\n        return this.__tracks;\n    };\n    return Playlist;\n}());\nexports.Playlist = Playlist;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/channel/Playlist.js\n// module id = 5\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar Track = (function (_super) {\n    __extends(Track, _super);\n    function Track(id, fileId, cueInAt, cueOutAt, cueOffset, fadeInAt, fadeOutAt) {\n        var _this = _super.call(this) || this;\n        _this.__id = id;\n        _this.__fileId = fileId;\n        _this.__cueInAt = cueInAt;\n        _this.__cueOutAt = cueOutAt;\n        _this.__cueOffset = cueOffset;\n        _this.__fadeInAt = fadeInAt;\n        _this.__fadeOutAt = fadeOutAt;\n        return _this;\n    }\n    Track.prototype.getId = function () {\n        return this.__id;\n    };\n    Track.prototype.getFileId = function () {\n        return this.__fileId;\n    };\n    Track.prototype._loggerTag = function () {\n        return this['constructor']['name'] + \" \" + this.__id;\n    };\n    return Track;\n}(Base_1.Base));\nexports.Track = Track;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/channel/Track.js\n// module id = 6\n// module chunks = 0","\"use strict\";\nvar Factory_1 = require(\"./Factory\");\nvar Source_1 = require(\"./Source\");\nvar AudioManager = (function () {\n    function AudioManager() {\n        this.__audioPlayers = {};\n    }\n    AudioManager.prototype.update = function (playlist, clock) {\n        var tracks = playlist.getTracks();\n        var existingIds = Object.keys(this.__audioPlayers);\n        var newIds = Object.keys(tracks);\n        var tracksToAdd = this.__diff(tracks, this.__audioPlayers);\n        var tracksToRemove = this.__diff(this.__audioPlayers, tracks);\n        console.log(\"tracksToAdd\", tracksToAdd);\n        console.log(\"tracksToRemove\", tracksToRemove);\n        for (var id in tracksToAdd) {\n            var track = tracks[id];\n            var mp3Url = \"https://essence.radiokitapp.org/api/cdn/v1.0/vault/file/\" + track.getFileId() + \"/variant/webbrowser-mp3\";\n            var opusUrl = \"https://essence.radiokitapp.org/api/cdn/v1.0/vault/file/\" + track.getFileId() + \"/variant/webbrowser-opus\";\n            this.__audioPlayers[id] = Factory_1.Factory.make(new Source_1.Source(mp3Url, opusUrl));\n            this.__audioPlayers[id].prepare();\n        }\n    };\n    AudioManager.prototype.cleanup = function () {\n    };\n    AudioManager.prototype.__diff = function (object1, object2) {\n        var result = {};\n        var array1 = Object.keys(object1);\n        var array2 = Object.keys(object2);\n        for (var _i = 0, array1_1 = array1; _i < array1_1.length; _i++) {\n            var item = array1_1[_i];\n            if (array2.indexOf(item) === -1) {\n                result[item] = object1[item];\n            }\n        }\n        return result;\n    };\n    return AudioManager;\n}());\nexports.AudioManager = AudioManager;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/audio/AudioManager.js\n// module id = 7\n// module chunks = 0","import { IAudioPlayer } from './IAudioPlayer';\nimport { WebAudioPlayer } from './WebAudioPlayer';\nimport { HTMLPlayer } from './HTMLPlayer';\nimport { Source } from './Source';\n\n\n/**\n * This class implements factory pattern for creating players that utilize\n * the most of browser capabilities.\n */\nexport class Factory {\n  /**\n   * Instantiates an audio player for given source.\n   *\n   * Performs browser capabilities test and selects the best player available.\n   */\n  public static make(source: Source) : IAudioPlayer {\n    if(WebAudioPlayer.isSupported()) {\n      return new WebAudioPlayer(source);\n\n    } else {\n      return new HTMLPlayer(source);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/Factory.ts","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar WebAudioPlayer = (function (_super) {\n    __extends(WebAudioPlayer, _super);\n    function WebAudioPlayer(source) {\n        var _this = _super.call(this) || this;\n        _this.debug(\"Construct\");\n        _this.source = source;\n        _this.audioContext = WebAudioPlayer.findAudioContext();\n        _this.request = new XMLHttpRequest();\n        _this.request.responseType = 'arraybuffer';\n        _this.request.addEventListener('load', _this.__onRequestLoad);\n        _this.request.addEventListener('error', _this.__onRequestError);\n        _this.request.addEventListener('abort', _this.__onRequestAbort);\n        return _this;\n    }\n    WebAudioPlayer.isSupported = function () {\n        return window.hasOwnProperty('AudioContext') || window.hasOwnProperty('webkitAudioContext');\n    };\n    WebAudioPlayer.findAudioContext = function () {\n        if (window.hasOwnProperty('AudioContext')) {\n            return window['AudioContext'];\n        }\n        else if (window.hasOwnProperty('webkitAudioContext')) {\n            return window['webkitAudioContext'];\n        }\n        else {\n            throw new Error('Unable to find AudioContext');\n        }\n    };\n    WebAudioPlayer.prototype.prepare = function () {\n        this.debug(\"Prepare\");\n        this.request.open('GET', this.source.getOpus(), true);\n        this.request.responseType = 'arraybuffer';\n        this.request.send();\n    };\n    WebAudioPlayer.prototype.play = function () {\n        this.debug(\"Play\");\n        return true;\n    };\n    WebAudioPlayer.prototype.stop = function () {\n        this.debug(\"Stop\");\n        return true;\n    };\n    WebAudioPlayer.prototype._loggerTag = function () {\n        return this['constructor']['name'];\n    };\n    WebAudioPlayer.prototype.__onRequestLoad = function (event) {\n        this.debug(\"Request Load\");\n        this.audioContext.decodeAudioData(this.request.response, this.__onAudioContextDecode);\n    };\n    WebAudioPlayer.prototype.__onRequestError = function (event) {\n        this.warn(\"Request Error\");\n    };\n    WebAudioPlayer.prototype.__onRequestAbort = function (event) {\n        this.warn(\"Request Abort\");\n    };\n    WebAudioPlayer.prototype.__onAudioContextDecode = function (buffer) {\n        this.debug(\"Audio Decode\");\n    };\n    return WebAudioPlayer;\n}(Base_1.Base));\nexports.WebAudioPlayer = WebAudioPlayer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/audio/WebAudioPlayer.js\n// module id = 9\n// module chunks = 0","import { IAudioPlayer } from './IAudioPlayer';\nimport { Source } from './Source';\n\n/**\n * This class wraps HTML5 <audio> tag into a player that is capable of playing\n * sound from a given source.\n *\n * Do not instantiate this directly, use Factory.make instead.\n */\nexport class HTMLPlayer implements IAudioPlayer {\n  private source: Source;\n\n  constructor(source: Source) {\n    this.source = source;\n  }\n\n\n  play() {\n    return true; // FIXME\n  }\n\n\n  stop() {\n    return true; // FIXME\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/HTMLPlayer.ts","export class Source {\n  private mp3: string;\n  private opus: string;\n\n\n  constructor(mp3: string, opus: string) {\n    this.mp3 = mp3;\n    this.opus = opus;\n  }\n\n\n  public getOpus() : string {\n    return this.opus\n  }\n\n\n  public getMp3() : string {\n    return this.mp3;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/Source.ts"],"sourceRoot":""}