{"version":3,"sources":["webpack:///webpack/bootstrap 7b88fd0b2219aeed5e77","webpack:///./lib/index.ts","webpack:///./lib/channel/Player.ts","webpack:///./lib/Base.ts","webpack:///./lib/clock/SyncClock.ts","webpack:///./lib/channel/PlaylistFetcher.ts","webpack:///./lib/channel/Playlist.ts","webpack:///./lib/channel/Track.ts","webpack:///./lib/channel/TrackInfo.ts","webpack:///./lib/audio/AudioManager.ts","webpack:///./lib/audio/Factory.ts","webpack:///./lib/audio/HTMLPlayer.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;ACtCA,oCAAwB,CAAkB,CAAC;AAE9B,gBAAO,GAAG;KACrB,uBAAM;EACP,CAAC;AAIF,GAAE,EAAC,OAAM,CAAC,MAAM,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;KAClC,MAAM,CAAC,yBAAyB,CAAC,GAAG;SAClC,OAAO,EAAE;aACP,uBAAM;UACP;MACF,CAAC;AACJ,EAAC;;;;;;;;;;;;;ACdD,kCAAqB,CAAS,CAAC;AAC/B,uCAA0B,CAAoB,CAAC;AAG/C,6CAAgC,CAA4B,CAAC;AAC7D,0CAA6B,CAAuB,CAAC;AAcrD;KAA4B,0BAAI;KAW9B,gBAAY,SAAiB,EAAE,WAAmB;SAChD,iBAAO,CAAC;SATF,qBAAgB,GAAa,CAAC,CAAC;SAG/B,YAAO,GAAyB,IAAI,CAAC;SACrC,sBAAiB,GAAqB,IAAI,CAAC;SAC3C,aAAQ,GAAqB,GAAG,CAAC;SAMvC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACvB,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;SAC7B,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC;KACnC,CAAC;KAGM,sBAAK,GAAZ;SACE,IAAI,CAAC,eAAe,EAAE,CAAC;SACvB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SAEtB,IAAI,CAAC,cAAc,GAAG,IAAI,2BAAY,EAAE,CAAC;SACzC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC7C,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,+BAA+B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC5F,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;SAC7E,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGM,qBAAI,GAAX;SACE,IAAI,CAAC,cAAc,EAAE,CAAC;SACtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SAGvB,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC;SAG7B,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;SAG7B,OAAO,IAAI,CAAC,cAAc,CAAC;SAC3B,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;SAEhC,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGM,0BAAS,GAAhB,UAAiB,MAAc;SAC7B,EAAE,EAAC,MAAM,GAAG,GAAG,IAAI,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;aAChC,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;SACzC,CAAC;SAED,IAAI,CAAC,KAAK,CAAC,mBAAiB,MAAQ,CAAC,CAAC;SAEtC,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;SAEvB,EAAE,EAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;aACvB,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACxC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGM,0BAAS,GAAhB;SACE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACvB,CAAC;KAGM,0BAAS,GAAhB;SACE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;KACxB,CAAC;KAGS,2BAAU,GAApB;SACE,MAAM,CAAI,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,SAAI,IAAI,CAAC,WAAa,CAAC;KAC9D,CAAC;KAGO,gCAAe,GAAvB;SACE,IAAI,CAAC,oBAAoB,EAAE,CAAC;KAC9B,CAAC;KAGO,+BAAc,GAAtB;SACE,EAAE,EAAC,IAAI,CAAC,gBAAgB,KAAK,CAAC,CAAC,CAAC,CAAC;aAC/B,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;aACpC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;SAC5B,CAAC;KACH,CAAC;KAGO,4BAAW,GAAnB;SAAA,iBA0BC;SAzBC,EAAE,EAAC,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;aACzB,IAAI,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;aAC5C,IAAM,OAAO,GAAG,IAAI,OAAO,CAAW,UAAC,OAAY,EAAE,MAAW;iBAC9D,qBAAS,CAAC,SAAS,EAAE;sBAClB,IAAI,CAAC,UAAC,KAAK;qBACV,KAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;qBACxC,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC;qBACrB,KAAI,CAAC,iBAAiB,GAAG,IAAI,iCAAe,CAAC,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;qBAE1F,MAAM,CAAC,KAAI,CAAC,eAAe,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;iBAC/C,CAAC,CAAC;sBACD,KAAK,CAAC,UAAC,KAAK;qBACX,KAAI,CAAC,IAAI,CAAC,wCAAsC,KAAK,CAAC,OAAO,MAAG,CAAC,CAAC;qBAClE,KAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;qBAC/B,MAAM,CAAC,IAAI,KAAK,CAAC,2BAAyB,KAAK,CAAC,OAAO,MAAG,CAAC,CAAC,CAAC;iBAC/D,CAAC,CAAC,CAAC;aACP,CAAC,CAAC,CAAC;aACH,MAAM,CAAC,OAAO,CAAC;SAEjB,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,IAAM,OAAO,GAAG,IAAI,OAAO,CAAW,UAAC,OAAY,EAAE,MAAW;iBAC9D,KAAI,CAAC,eAAe,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;aACxC,CAAC,CAAC,CAAC;aACH,MAAM,CAAC,OAAO,CAAC;SACjB,CAAC;KACH,CAAC;KAGO,gCAAe,GAAvB,UAAwB,OAAY,EAAE,MAAW;SAAjD,iBAYC;SAXC,IAAI,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC;SAC1C,IAAI,CAAC,iBAAiB,CAAC,UAAU,EAAE;cAChC,IAAI,CAAC,UAAC,QAAQ;aACb,KAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;aAC1B,OAAO,CAAC,QAAQ,CAAC,CAAC;SACpB,CAAC,CAAC;cACD,KAAK,CAAC,UAAC,KAAK;aACX,KAAI,CAAC,IAAI,CAAC,4CAA0C,KAAK,CAAC,OAAO,MAAG,CAAC,CAAC;aACtE,KAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;aAC/B,MAAM,CAAC,IAAI,KAAK,CAAC,+BAA6B,KAAK,CAAC,OAAO,MAAG,CAAC,CAAC,CAAC;SACnE,CAAC,CAAC,CAAC;KACP,CAAC;KAGO,qCAAoB,GAA5B;SAAA,iBAWC;SAVC,IAAI,CAAC,WAAW,EAAE;cACf,IAAI,CAAC,UAAC,QAAQ;aACb,EAAE,EAAC,KAAI,CAAC,SAAS,CAAC,CAAC,CAAC;iBAClB,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,KAAI,CAAC,OAAO,CAAC,CAAC;aACrD,CAAC;aACD,KAAI,CAAC,mBAAmB,EAAE,CAAC;SAC7B,CAAC,CAAC;cACD,KAAK,CAAC,UAAC,KAAK;aACX,KAAI,CAAC,mBAAmB,EAAE,CAAC;SAC7B,CAAC,CAAC,CAAC;KACP,CAAC;KAGO,oCAAmB,GAA3B;SAAA,iBASC;SARC,EAAE,EAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;aAClB,IAAM,OAAO,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC;aACvD,IAAI,CAAC,KAAK,CAAC,qCAAmC,OAAO,QAAK,CAAC,CAAC;aAC5D,IAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC;iBACjC,KAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;iBAC1B,KAAI,CAAC,oBAAoB,EAAE,CAAC;aAC9B,CAAC,EAAE,OAAO,CAAC,CAAC;SACd,CAAC;KACH,CAAC;KAGO,yCAAwB,GAAhC,UAAiC,KAAY,EAAE,QAAgB,EAAE,QAAgB;SAC/E,IAAI,CAAC,QAAQ,CAAC,gBAAgB,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;KAC7D,CAAC;KAGO,gDAA+B,GAAvC,UAAwC,KAAY;SAClD,IAAI,CAAC,QAAQ,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;KACjD,CAAC;KACH,aAAC;AAAD,EAAC,CA7K2B,WAAI,GA6K/B;AA7KY,eAAM,SA6KlB;;;;;;;;AChMD;KAAA;SACU,aAAQ,GAAW,EAAE,CAAC;KAqFhC,CAAC;KA/EQ,iBAAE,GAAT,UAAU,SAAiB,EAAE,QAAQ;SACnC,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;aAC3C,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;iBACrD,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC1C,CAAC;aAAC,IAAI,CAAC,CAAC;iBACN,MAAM,IAAI,KAAK,CAAC,wDAAqD,SAAS,OAAG,CAAC,CAAC;aACrF,CAAC;SACH,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SACxC,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAMM,kBAAG,GAAV,UAAW,SAAiB,EAAE,QAAQ;SACpC,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;aAC3C,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;aACzD,EAAE,EAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;iBAChB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAC5C,CAAC;aAAC,IAAI,CAAC,CAAC;iBACN,MAAM,IAAI,KAAK,CAAC,wDAAqD,SAAS,OAAG,CAAC,CAAC;aACrF,CAAC;SACH,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAQM,qBAAM,GAAb,UAAc,SAAkB;SAC9B,EAAE,EAAC,SAAS,CAAC,CAAC,CAAC;aACb,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;iBAC3C,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;aAClC,CAAC;SACH,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;SACrB,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGS,uBAAQ,GAAlB,UAAmB,SAAS;SAAE,cAAc;cAAd,WAAc,CAAd,sBAAc,CAAd,IAAc;aAAd,6BAAc;;SAC1C,IAAI,CAAC,KAAK,CAAC,YAAU,SAAS,UAAK,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAG,CAAC,CAAC;SAE5D,EAAE,EAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;aAC3C,GAAG,EAAiB,UAAwB,EAAxB,SAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAxB,cAAwB,EAAxB,IAAwB,CAAC;iBAAzC,IAAI,QAAQ;iBACd,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;cAC5B;SACH,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAMS,mBAAI,GAAd,UAAe,OAAe;SAC5B,OAAO,CAAC,IAAI,CAAC,MAAI,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,mCAA8B,IAAI,CAAC,UAAU,EAAE,UAAK,OAAS,CAAC,CAAC;KAC1G,CAAC;KAGS,mBAAI,GAAd,UAAe,OAAe;SAC5B,OAAO,CAAC,IAAI,CAAC,MAAI,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,mCAA8B,IAAI,CAAC,UAAU,EAAE,UAAK,OAAS,CAAC,CAAC;KAC1G,CAAC;KAGS,oBAAK,GAAf,UAAgB,OAAe;SAC7B,OAAO,CAAC,KAAK,CAAC,MAAI,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,mCAA8B,IAAI,CAAC,UAAU,EAAE,UAAK,OAAS,CAAC,CAAC;KAC3G,CAAC;KACH,WAAC;AAAD,EAAC;AAtFqB,aAAI,OAsFzB;;;;;;;;;;;;;ACtFD,kCAAqB,CAAS,CAAC;AAc/B;KAA+B,6BAAI;KAsDjC,mBAAY,UAAkB;SAC5B,iBAAO,CAAC;SACR,IAAI,CAAC,QAAQ,GAAG,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;SAExC,IAAI,CAAC,KAAK,CAAC,kCAAgC,IAAI,CAAC,QAAQ,QAAK,CAAC,CAAC;KACjE,CAAC;KApDa,mBAAS,GAAvB;SACE,IAAM,OAAO,GAAG,IAAI,OAAO,CAAY,UAAC,OAAY,EAAE,MAAW;aAC/D,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;aAEjC,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,gDAAgD,EAAE,IAAI,CAAC,CAAC;aAC5E,GAAG,CAAC,gBAAgB,CAAC,eAAe,EAAE,2BAA2B,CAAC,CAAC;aACnE,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC;aAEnB,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,iDAA+C,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;aAClF,CAAC;aAED,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC,CAAC;aAC5D,CAAC;aAED,GAAG,CAAC,SAAS,GAAG,UAAS,CAAC;iBACxB,MAAM,CAAC,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC,CAAC;aAC5D,CAAC;aAGD,GAAG,CAAC,kBAAkB,GAAG;iBACvB,EAAE,EAAC,GAAG,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC;qBACxB,EAAE,EAAC,GAAG,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;yBACtB,OAAO,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;qBAE5E,CAAC;qBAAC,IAAI,CAAC,CAAC;yBACN,MAAM,CAAC,IAAI,KAAK,CAAC,gEAA8D,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;qBACjG,CAAC;iBACH,CAAC;aACH,CAAC,CAAC;aAEF,GAAG,CAAC,IAAI,EAAE,CAAC;SACb,CAAC,CAAC,CAAC;SAGH,MAAM,CAAC,OAAO,CAAC;KACjB,CAAC;KAkBM,kCAAc,GAArB;SACE,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC;KACpC,CAAC;KAGS,8BAAU,GAApB;SACE,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,CAAC;KACrC,CAAC;KACH,gBAAC;AAAD,EAAC,CAtE8B,WAAI,GAsElC;AAtEY,kBAAS,YAsErB;;;;;;;;AClFD,sCAAyB,CAAY,CAAC;AAOtC;KAME,yBAAY,WAAmB,EAAE,SAAiB,EAAE,KAAgB;SAClE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;SACrB,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;SAC7B,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC;KACnC,CAAC;KAMM,oCAAU,GAAjB;SAAA,iBAqDC;SApDC,IAAM,OAAO,GAAG,IAAI,OAAO,CAAW,UAAC,OAAY,EAAE,MAAW;aAC9D,IAAM,GAAG,GAAG,KAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;aAC1C,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;aAEjC,IAAM,GAAG,GAAG,+EAA+E;iBACzF,SAAS;iBACT,WAAW;iBACX,WAAW;iBACX,gBAAgB;iBAChB,iBAAiB;iBACjB,iBAAiB;iBACjB,iBAAiB;iBACjB,kBAAkB;iBAClB,aAAa,GAAG,kBAAkB,CAAC,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC,GAAG,aAAa;iBAC/E,gDAAgD,GAAG,kBAAkB,CAAC,KAAI,CAAC,WAAW,CAAC;iBACvF,sBAAsB,CAAC;aAGzB,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;aAC3B,GAAG,CAAC,gBAAgB,CAAC,eAAe,EAAE,2BAA2B,CAAC,CAAC;aACnE,GAAG,CAAC,gBAAgB,CAAC,eAAe,EAAE,YAAU,KAAI,CAAC,aAAe,CAAC,CAAC;aACtE,GAAG,CAAC,gBAAgB,CAAC,QAAQ,EAAE,kBAAkB,CAAC,CAAC;aACnD,GAAG,CAAC,OAAO,GAAG,KAAK,CAAC;aAEpB,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,8CAA4C,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;aAC/E,CAAC;aAED,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC;aACzD,CAAC;aAED,GAAG,CAAC,SAAS,GAAG,UAAS,CAAC;iBACxB,MAAM,CAAC,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC;aACzD,CAAC;aAED,GAAG,CAAC,kBAAkB,GAAG;iBACvB,EAAE,EAAC,GAAG,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC;qBACxB,EAAE,EAAC,GAAG,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;yBACtB,IAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;yBACpD,OAAO,CAAC,mBAAQ,CAAC,YAAY,CAAC,KAAI,CAAC,aAAa,EAAE,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;qBAE7E,CAAC;qBAAC,IAAI,CAAC,CAAC;yBACN,MAAM,CAAC,IAAI,KAAK,CAAC,6DAA2D,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;qBAC9F,CAAC;iBACH,CAAC;aACH,CAAC,CAAC;aAEF,GAAG,CAAC,IAAI,EAAE,CAAC;SACb,CAAC,CAAC,CAAC;SAEH,MAAM,CAAC,OAAO,CAAC;KACjB,CAAC;KACH,sBAAC;AAAD,EAAC;AAtEY,wBAAe,kBAsE3B;;;;;;;;AC9ED,mCAAsB,CAAS,CAAC;AAOhC;KA2BE,kBAAY,MAAc;SACxB,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;KACzB,CAAC;KAtBa,qBAAY,GAA1B,UAA2B,WAAmB,EAAE,IAAmB;SACjE,IAAI,MAAM,GAAY,EAAE,CAAC;SAEzB,GAAG,EAAe,UAAI,EAAJ,aAAI,EAAJ,kBAAI,EAAJ,IAAI,CAAC;aAAnB,IAAI,MAAM;aACZ,IAAI,EAAE,GAA2B,MAAM,CAAC,IAAI,CAAC,CAAC;aAC9C,IAAI,MAAM,GAAuB,MAAM,CAAC,MAAM,CAAC,CAAC;aAChD,IAAI,OAAO,GAAsB,IAAI,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;aAC/D,IAAI,QAAQ,GAAqB,IAAI,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;aAChE,IAAI,SAAS,GAAoB,MAAM,CAAC,YAAY,CAAC,CAAC;aACtD,IAAI,QAAQ,GAAqB,MAAM,CAAC,YAAY,CAAC,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,GAAG,IAAI,CAAC;aACvG,IAAI,SAAS,GAAoB,MAAM,CAAC,aAAa,CAAC,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,GAAG,IAAI,CAAC;aAEzG,IAAI,KAAK,GAAG,IAAI,aAAK,CAAC,WAAW,EAAE,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;aAClG,MAAM,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;UACpB;SAED,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,CAAC;KAC9B,CAAC;KAQM,4BAAS,GAAhB;SACE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACvB,CAAC;KACH,eAAC;AAAD,EAAC;AAnCY,iBAAQ,WAmCpB;;;;;;;;;;;;;AC3CD,kCAAqB,CAAS,CAAC;AAC/B,uCAA0B,CAAa,CAAC;AAIxC;KAA2B,yBAAI;KAW7B,eAAY,WAAmB,EAAE,EAAU,EAAE,MAAc,EAAE,OAAa,EAAE,QAAc,EAAE,SAAiB,EAAE,QAAe,EAAE,SAAgB;SAC9I,iBAAO,CAAC;SAER,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC;SACjC,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;SACf,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;SACvB,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC;SACzB,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;SAC3B,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;SAC7B,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;SAC3B,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;KAC/B,CAAC;KAGM,qBAAK,GAAZ;SACE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;KACnB,CAAC;KAGM,yBAAS,GAAhB;SACE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;KACvB,CAAC;KAGM,0BAAU,GAAjB;SACE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;KACxB,CAAC;KAGM,2BAAW,GAAlB;SACE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;KACzB,CAAC;KAGM,2BAAW,GAAlB;SACE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;KACzB,CAAC;KAGM,4BAAY,GAAnB;SACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;KAC1B,CAAC;KAGM,4BAAY,GAAnB;SACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;KAC1B,CAAC;KAGM,4BAAY,GAAnB;SAAA,iBAsFC;SArFC,IAAM,OAAO,GAAG,IAAI,OAAO,CAAY,UAAC,OAAY,EAAE,MAAW;aAC/D,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;aAEjC,IAAM,GAAG,GAAG,8DAA8D;iBACxE,SAAS;iBACT,WAAW;iBACX,YAAY;iBACZ,iBAAiB;iBACjB,YAAY;iBACZ,iBAAiB;iBAEjB,2BAA2B;iBAC3B,6BAA6B;iBAC7B,4BAA4B;iBAC5B,6BAA6B;iBAE7B,yBAAyB;iBACzB,0CAA0C;iBAC1C,yCAAyC;iBAEzC,0BAA0B;iBAC1B,4BAA4B;iBAC5B,2BAA2B;iBAC3B,4BAA4B;iBAE5B,wBAAwB;iBACxB,wCAAwC;iBACxC,wCAAwC;iBACxC,kCAAkC;iBAClC,8BAA8B;iBAC9B,gCAAgC;iBAChC,iCAAiC;iBACjC,mCAAmC;iBACnC,oCAAoC;iBACpC,gCAAgC;iBAChC,oCAAoC;iBACpC,gCAAgC;iBAChC,gCAAgC;iBAChC,iCAAiC;iBACjC,+BAA+B;iBAE/B,uBAAuB;iBACvB,qBAAqB;iBACrB,wBAAwB;iBACxB,sBAAsB;iBAEtB,gBAAgB,GAAG,kBAAkB,CAAC,KAAI,CAAC,QAAQ,CAAC,CAAC;aAEvD,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;aAC3B,GAAG,CAAC,gBAAgB,CAAC,eAAe,EAAE,YAAU,KAAI,CAAC,aAAe,CAAC,CAAC;aACtE,GAAG,CAAC,gBAAgB,CAAC,QAAQ,EAAE,kBAAkB,CAAC,CAAC;aACnD,GAAG,CAAC,OAAO,GAAG,KAAK,CAAC;aAEpB,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,8CAA4C,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;aAC/E,CAAC;aAED,GAAG,CAAC,OAAO,GAAG,UAAS,CAAC;iBACtB,MAAM,CAAC,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC;aACzD,CAAC;aAED,GAAG,CAAC,SAAS,GAAG,UAAS,CAAC;iBACxB,MAAM,CAAC,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC,CAAC;aACzD,CAAC;aAED,GAAG,CAAC,kBAAkB,GAAG;iBACvB,EAAE,EAAC,GAAG,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC;qBACxB,EAAE,EAAC,GAAG,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;yBACtB,IAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;yBACpD,EAAE,EAAC,cAAc,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;6BACvC,OAAO,CAAC,qBAAS,CAAC,YAAY,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;yBAC7D,CAAC;yBAAC,IAAI,CAAC,CAAC;6BACN,MAAM,CAAC,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC,CAAC;yBACpE,CAAC;qBAEH,CAAC;qBAAC,IAAI,CAAC,CAAC;yBACN,MAAM,CAAC,IAAI,KAAK,CAAC,+DAA6D,GAAG,CAAC,MAAM,MAAG,CAAC,CAAC,CAAC;qBAChG,CAAC;iBACH,CAAC;aACH,CAAC,CAAC;aAEF,GAAG,CAAC,IAAI,EAAE,CAAC;SACb,CAAC,CAAC,CAAC;SAEH,MAAM,CAAC,OAAO,CAAC;KACjB,CAAC;KAGS,0BAAU,GAApB;SACE,MAAM,CAAI,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,SAAI,IAAI,CAAC,IAAM,CAAC;KACvD,CAAC;KACH,YAAC;AAAD,EAAC,CAxJ0B,WAAI,GAwJ9B;AAxJY,cAAK,QAwJjB;;;;;;;;AC7JD;KA6CE,mBAAY,IAAY,EAAE,QAAgB,EAAE,UAAkB;SAC5D,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACnB,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;SAC3B,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC;KACjC,CAAC;KAxCa,sBAAY,GAA1B,UAA2B,IAAY;SACrC,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;SAC1B,IAAM,QAAQ,GAAG,EAAE,CAAC;SACpB,IAAM,UAAU,GAAG,EAAE,CAAC;SAGtB,IAAM,eAAe,GAAG,EAAE,CAAC;SAC3B,GAAG,EAAuB,UAAwB,EAAxB,SAAI,CAAC,kBAAkB,CAAC,EAAxB,cAAwB,EAAxB,IAAwB,CAAC;aAA/C,IAAI,cAAc;aACpB,eAAe,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,GAAG,cAAc,CAAC;UACxD;SAED,IAAM,gBAAgB,GAAG,EAAE,CAAC;SAC5B,GAAG,EAAwB,UAAyB,EAAzB,SAAI,CAAC,mBAAmB,CAAC,EAAzB,cAAyB,EAAzB,IAAyB,CAAC;aAAjD,IAAI,eAAe;aACrB,gBAAgB,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,GAAG,eAAe,CAAC;UAC3D;SAGD,GAAG,EAAqB,UAAsB,EAAtB,SAAI,CAAC,gBAAgB,CAAC,EAAtB,cAAsB,EAAtB,IAAsB,CAAC;aAA3C,IAAI,YAAY;aAClB,IAAI,GAAG,GAAG,eAAe,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC,CAAC,GAAG,CAAC;aAClE,IAAI,IAAI,GAAG,eAAe,CAAC,YAAY,CAAC,oBAAoB,CAAC,CAAC,CAAC,IAAI,CAAC;aACpE,IAAI,KAAK,GAAG,YAAY,CAAC,YAAS,IAAI,CAAE,CAAC,CAAC;aAE1C,QAAQ,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;UACvB;SAED,GAAG,EAAsB,UAAuB,EAAvB,SAAI,CAAC,iBAAiB,CAAC,EAAvB,cAAuB,EAAvB,IAAuB,CAAC;aAA7C,IAAI,aAAa;aACnB,IAAI,GAAG,GAAG,gBAAgB,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC,CAAC,GAAG,CAAC;aACrE,IAAI,KAAK,GAAG,aAAa,CAAC,oBAAoB,CAAC,CAAC;aAEhD,UAAU,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;UACzB;SAED,MAAM,CAAC,IAAI,SAAS,CAAC,IAAI,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;KACnD,CAAC;KAUM,2BAAO,GAAd;SACE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;KACrB,CAAC;KAGM,+BAAW,GAAlB;SACE,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;KACzB,CAAC;KAGM,iCAAa,GAApB;SACE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC;KAC3B,CAAC;KACH,gBAAC;AAAD,EAAC;AAjEY,kBAAS,YAiErB;;;;;;;;;;;;;ACjED,qCAAwB,CAAW,CAAC;AAKpC,kCAAqB,CAAS,CAAC;AAe/B;KAAkC,gCAAI;KAAtC;SAAkC,8BAAI;SAC5B,mBAAc,GAAa,EAAE,CAAC;SAC9B,aAAQ,GAAmB,GAAG,CAAC;KAoHzC,CAAC;KAzGQ,6BAAM,GAAb,UAAc,QAAkB,EAAE,KAAgB;SAChD,IAAM,MAAM,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC;SAGpC,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACrD,IAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SAInC,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;SAC7D,IAAM,cAAc,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;SAEhE,GAAG,EAAC,IAAI,EAAE,IAAI,WAAW,CAAC,CAAC,CAAC;aAC1B,IAAI,CAAC,KAAK,CAAC,wBAAsB,EAAI,CAAC,CAAC;aACvC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,GAAG,iBAAO,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;aACnE,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,8BAA8B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aAC/F,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aAChF,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC;SAClC,CAAC;SAED,GAAG,EAAC,IAAI,EAAE,IAAI,cAAc,CAAC,CAAC,CAAC;aAC7B,IAAI,CAAC,KAAK,CAAC,0BAAwB,EAAI,CAAC,CAAC;aACzC,IAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;SAC/B,CAAC;KACH,CAAC;KAMM,8BAAO,GAAd;SACE,GAAG,EAAC,IAAI,EAAE,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;aAClC,IAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;SAC/B,CAAC;KACH,CAAC;KAMM,gCAAS,GAAhB,UAAiB,MAAc;SAC7B,EAAE,EAAC,MAAM,GAAG,GAAG,IAAI,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;aAChC,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;SACzC,CAAC;SAED,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;SAEvB,GAAG,EAAC,IAAI,EAAE,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;aAClC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SAC5C,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGS,iCAAU,GAApB;SACE,MAAM,CAAC,KAAG,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAG,CAAC;KAC1C,CAAC;KAGO,0CAAmB,GAA3B,UAA4B,EAAU;SAGpC,EAAE,EAAC,IAAI,CAAC,cAAc,KAAK,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;aAC9D,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;SAClC,CAAC;SAGD,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC;SAGjC,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;SAG/B,OAAO,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;KACjC,CAAC;KAGO,6BAAM,GAAd,UAAe,OAAgB,EAAE,OAAgB;SAC/C,IAAM,MAAM,GAAG,EAAE,CAAC;SAElB,IAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACpC,IAAM,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAEpC,GAAG,EAAa,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,CAAC;aAAnB,IAAI,IAAI;aACV,EAAE,EAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC/B,MAAM,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;aAC/B,CAAC;UACF;SAED,MAAM,CAAC,MAAM,CAAC;KAChB,CAAC;KAGO,qDAA8B,GAAtC,UAAuC,KAAY;SACjD,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;SAC5B,IAAI,CAAC,QAAQ,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC;KAC3C,CAAC;KAGO,8CAAuB,GAA/B,UAAgC,KAAY,EAAE,QAAgB,EAAE,QAAgB;SAC9E,EAAE,EAAC,KAAK,KAAK,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;aACjC,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;SACvD,CAAC;KACH,CAAC;KACH,mBAAC;AAAD,EAAC,CAtHiC,WAAI,GAsHrC;AAtHY,qBAAY,eAsHxB;;;;;;;;ACzID,wCAA2B,EAAc,CAAC;AAS1C;KAAA;KAOA,CAAC;KAHe,qBAAa,GAA3B,UAA4B,KAAY,EAAE,KAAgB;SACxD,MAAM,CAAC,IAAI,uBAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;KACtC,CAAC;KACH,cAAC;AAAD,EAAC;AAPY,gBAAO,UAOnB;;;;;;;;;;;;;ACdD,kCAAqB,CAAS,CAAC;AAe/B;KAAgC,8BAAI;KAWlC,oBAAY,KAAY,EAAE,KAAgB;SACxC,iBAAO,CAAC;SARF,cAAS,GAAuB,KAAK,CAAC;SACtC,qBAAgB,GAAe,CAAC,CAAC;SACjC,uBAAkB,GAAa,CAAC,CAAC;SACjC,yBAAoB,GAAW,CAAC,CAAC;SACjC,aAAQ,GAAuB,GAAG,CAAC;SAMzC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;SACrB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACvB,CAAC;KAeM,0BAAK,GAAZ;SACE,EAAE,EAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;aACnB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;aACvB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;aAEtB,IAAI,CAAC,iBAAiB,EAAE,CAAC;SAE3B,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,MAAM,IAAI,KAAK,CAAC,sDAAsD,CAAC,CAAC;SAC1E,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAMM,yBAAI,GAAX;SACE,EAAE,EAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;aAClB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;aACvB,IAAI,CAAC,cAAc,EAAE,CAAC;aAEtB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SAEzB,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;SACrE,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGM,8BAAS,GAAhB,UAAiB,MAAc;SAC7B,EAAE,EAAC,MAAM,GAAG,GAAG,IAAI,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;aAChC,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;SACzC,CAAC;SAED,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC;SAEvB,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;aAChB,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;SAC/B,CAAC;SAED,MAAM,CAAC,IAAI,CAAC;KACd,CAAC;KAGM,6BAAQ,GAAf;SACE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC;KACtB,CAAC;KAGS,+BAAU,GAApB;SACE,MAAM,CAAI,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC,SAAI,IAAI,CAAC,OAAO,CAAC,KAAK,EAAI,CAAC;KAClE,CAAC;KAGO,4CAAuB,GAA/B,UAAgC,CAAC;SAC/B,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;SAC9B,IAAI,CAAC,OAAO,CAAC,gBAAgB,GAAG,SAAS,CAAC;SAE1C,IAAM,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;SAC1C,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,OAAO,EAAE,CAAC;SACpD,IAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,OAAO,EAAE,CAAC;SAEtD,EAAE,EAAC,GAAG,IAAI,QAAQ,CAAC,CAAC,CAAC;aAEnB,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;SAElC,CAAC;SAAC,IAAI,CAAC,CAAC;aAEN,EAAE,EAAC,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC;iBAEjB,IAAM,OAAO,GAAG,OAAO,GAAG,GAAG,CAAC;iBAC9B,IAAI,CAAC,KAAK,CAAC,iBAAe,OAAO,QAAK,CAAC,CAAC;iBACxC,IAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,CAAC;aAEhF,CAAC;aAAC,IAAI,CAAC,EAAE,EAAC,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC;iBAExB,IAAM,QAAQ,GAAG,GAAG,GAAG,OAAO,CAAC;iBAC/B,IAAI,CAAC,KAAK,CAAC,gBAAc,QAAQ,QAAK,CAAC,CAAC;iBAExC,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,QAAQ,GAAG,MAAM,CAAC;iBAC7C,IAAI,CAAC,eAAe,EAAE,CAAC;aAEzB,CAAC;aAAC,IAAI,CAAC,CAAC;iBAEN,IAAI,CAAC,eAAe,EAAE,CAAC;aACzB,CAAC;SACH,CAAC;KACH,CAAC;KAGO,mCAAc,GAAtB,UAAuB,CAAC;SACtB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACnB,IAAI,CAAC,cAAc,EAAE,CAAC;SACtB,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC3B,CAAC;KAGO,mCAAc,GAAtB,UAAuB,CAAC;SACtB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SAClB,IAAI,CAAC,cAAc,EAAE,CAAC;KACxB,CAAC;KAGO,qCAAgB,GAAxB,UAAyB,CAAC;SACxB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KACvB,CAAC;KAGO,qCAAgB,GAAxB,UAAyB,CAAC;SACxB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KACvB,CAAC;KAGO,uCAAkB,GAA1B,UAA2B,CAAC;SAC1B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KACzB,CAAC;KAGO,qCAAgB,GAAxB;SACE,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,CAAC;SACxC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;SAC1B,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC3B,CAAC;KAGO,sCAAiB,GAAzB;SACE,IAAI,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC;SACjC,IAAI,CAAC,OAAO,GAAG,IAAI,KAAK,EAAE,CAAC;SAC3B,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC;SACpC,IAAI,CAAC,OAAO,CAAC,gBAAgB,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACxE,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACtD,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAEtD,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,8BAA8B,CAAC,CAAC,CAAC,CAAC;aAC5D,IAAI,CAAC,OAAO,CAAC,GAAG,GAAG,6DAA2D,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,6BAA0B,CAAC;SAEnI,CAAC;SAAC,IAAI,CAAC,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;aACjD,IAAI,CAAC,OAAO,CAAC,GAAG,GAAG,6DAA2D,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,4BAAyB,CAAC;SAElI,CAAC;SAAC,IAAI,CAAC,CAAC;aACN,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;SACvE,CAAC;KACH,CAAC;KAGO,oCAAe,GAAvB;SACE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;SAChC,IAAI,CAAC,oBAAoB,GAAG,WAAW,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;SAEnF,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1D,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1D,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5D,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;SAEpB,IAAI,CAAC,QAAQ,CAAC,kBAAkB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;KAClD,CAAC;KAGO,mCAAc,GAAtB;SACE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;SAChC,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;aAChB,IAAI,CAAC,OAAO,CAAC,gBAAgB,GAAG,SAAS,CAAC;aAC1C,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC;aACjC,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC;aACjC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;aACnC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;aACnC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;aACnC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;aACrB,OAAO,IAAI,CAAC,OAAO,CAAC;aACpB,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;SAC3B,CAAC;SAED,EAAE,EAAC,IAAI,CAAC,gBAAgB,KAAK,CAAC,CAAC,CAAC,CAAC;aAC/B,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;aACpC,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;SAC5B,CAAC;SAED,EAAE,EAAC,IAAI,CAAC,kBAAkB,KAAK,CAAC,CAAC,CAAC,CAAC;aACjC,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;aACtC,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;SAC9B,CAAC;SAED,EAAE,EAAC,IAAI,CAAC,oBAAoB,KAAK,CAAC,CAAC,CAAC,CAAC;aACnC,aAAa,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;aACzC,IAAI,CAAC,oBAAoB,GAAG,CAAC,CAAC;SAChC,CAAC;KACH,CAAC;KAGO,sCAAiB,GAAzB;SAAA,iBASC;SARC,EAAE,EAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;aAClB,IAAM,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC;aACtD,IAAI,CAAC,KAAK,CAAC,2BAAyB,OAAO,QAAK,CAAC,CAAC;aAClD,IAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC;iBACnC,KAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;iBAC5B,KAAI,CAAC,iBAAiB,EAAE,CAAC;aAC3B,CAAC,EAAE,OAAO,CAAC,CAAC;SACd,CAAC;KACH,CAAC;KAGO,yCAAoB,GAA5B;SACE,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC;SAC7D,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,OAAO,EAAE,CAAC;SACpD,IAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,OAAO,EAAE,CAAC;SACtD,IAAM,QAAQ,GAAG,QAAQ,GAAG,OAAO,CAAC;SAEpC,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;KAC9D,CAAC;KACH,iBAAC;AAAD,EAAC,CApP+B,WAAI,GAoPnC;AApPY,mBAAU,aAoPtB","file":"radiokit-toolkit-playback.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7b88fd0b2219aeed5e77","import { Player }  from './channel/Player';\n\nexport const Channel = {\n  Player,\n};\n\n\n// TODO remove\nif(typeof(window) !== \"undefined\") {\n  window['RadioKitToolkitPlayback'] = {\n    Channel: {\n      Player,\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/index.ts","import { Base } from '../Base';\nimport { SyncClock } from '../clock/SyncClock';\nimport { Playlist } from '../channel/Playlist';\nimport { Track } from '../channel/Track';\nimport { PlaylistFetcher } from '../channel/PlaylistFetcher';\nimport { AudioManager } from '../audio/AudioManager';\n\n\n/**\n * This class represents a single channel (stream) that is broadcasted from\n * RadioKit servers.\n *\n * It emits the following events:\n *\n * - error-network (no args) - when network error was encountered\n * - track-playback-started (arg1: track) - when playback starts\n * - track-position (arg1: track, arg1: position in ms, arg2: duration in ms) -\n *   when the position is updated for the last track for which playback has started\n */\nexport class Player extends Base {\n  private __channelId:        string;\n  private __accessToken:      string;\n  private __fetchTimeoutId:   number = 0;\n  private __audioManager:     AudioManager;\n  private __started:          boolean;\n  private __clock?:           SyncClock = null;\n  private __playlistFetcher?: PlaylistFetcher = null;\n  private __volume:           number = 1.0;\n\n\n  constructor(channelId: string, accessToken: string) {\n    super();\n\n    this.__started = false;\n    this.__channelId = channelId;\n    this.__accessToken = accessToken;\n  }\n\n\n  public start() : Player {\n    this.__startFetching();\n    this.__started = true;\n\n    this.__audioManager = new AudioManager();\n    this.__audioManager.setVolume(this.__volume);\n    this.__audioManager.on('playback-started', this.__onAudioManagerPlaybackStarted.bind(this));\n    this.__audioManager.on('position', this.__onAudioManagerPosition.bind(this));\n    return this;\n  }\n\n\n  public stop() : Player {\n    this.__stopFetching();\n    this.__started = false;\n\n    // Remove all event handlers to avoid memory leaks\n    this.__audioManager.offAll();\n\n    // Cleanup audio manager to avoid memory leaks\n    this.__audioManager.cleanup()\n\n    // Remove audio manager\n    delete this.__audioManager;\n    this.__audioManager = undefined;\n\n    return this;\n  }\n\n\n  public setVolume(volume: number) : Player {\n    if(volume < 0.0 || volume > 1.0) {\n      throw new Error('Volume out of range');\n    }\n\n    this.debug(`Volume set to ${volume}`);\n\n    this.__volume = volume;\n\n    if(this.__audioManager) {\n      this.__audioManager.setVolume(volume);\n    }\n\n    return this;\n  }\n\n\n  public getVolume() : number {\n    return this.__volume;\n  }\n\n\n  public isStarted() : boolean {\n    return this.__started;\n  }\n\n\n  protected _loggerTag() : string {\n    return `${this['constructor']['name']} ${this.__channelId}`;\n  }\n\n\n  private __startFetching() : void {\n    this.__fetchOnceAndRepeat();\n  }\n\n\n  private __stopFetching() : void {\n    if(this.__fetchTimeoutId !== 0) {\n      clearTimeout(this.__fetchTimeoutId);\n      this.__fetchTimeoutId = 0;\n    }\n  }\n\n\n  private __fetchOnce() : Promise<Playlist> {\n    if(this.__clock === null) {\n      this.debug(\"Fetch: Synchronizing clock...\");\n      const promise = new Promise<Playlist>((resolve: any, reject: any) => {\n        SyncClock.makeAsync()\n          .then((clock) => {\n            this.debug(\"Fetch: Synchronized clock\");\n            this.__clock = clock;\n            this.__playlistFetcher = new PlaylistFetcher(this.__accessToken, this.__channelId, clock);\n\n            return this.__fetchPlaylist(resolve, reject);\n          })\n          .catch((error) => {\n            this.warn(`Fetch error: Unable to sync clock (${error.message})`);\n            this._trigger('error-network');\n            reject(new Error(`Unable to sync clock (${error.message})`));\n          });\n      });\n      return promise;\n\n    } else {\n      const promise = new Promise<Playlist>((resolve: any, reject: any) => {\n        this.__fetchPlaylist(resolve, reject);\n      });\n      return promise;\n    }\n  }\n\n\n  private __fetchPlaylist(resolve: any, reject: any) : void {\n    this.debug(\"Fetch: Fetching playlist...\");\n    this.__playlistFetcher.fetchAsync()\n      .then((playlist) => {\n        this.debug(\"Fetch: Done\");\n        resolve(playlist);\n      })\n      .catch((error) => {\n        this.warn(`Fetch error: Unable to fetch playlist (${error.message})`);\n        this._trigger('error-network');\n        reject(new Error(`Unable to fetch playlist (${error.message})`));\n      });\n  }\n\n\n  private __fetchOnceAndRepeat() : void {\n    this.__fetchOnce()\n      .then((playlist) => {\n        if(this.__started) {\n          this.__audioManager.update(playlist, this.__clock);\n        }\n        this.__scheduleNextFetch();\n      })\n      .catch((error) => {\n        this.__scheduleNextFetch();\n      });\n  }\n\n\n  private __scheduleNextFetch() : void {\n    if(this.__started) {\n      const timeout = 2000 + Math.round(Math.random() * 250);\n      this.debug(`Fetch: Scheduling next fetch in ${timeout} ms`);\n      this.__fetchTimeoutId = setTimeout(() => {\n        this.__fetchTimeoutId = 0;\n        this.__fetchOnceAndRepeat();\n      }, timeout);\n    }\n  }\n\n\n  private __onAudioManagerPosition(track: Track, position: number, duration: number) : void {\n    this._trigger('track-position', track, position, duration);\n  }\n\n\n  private __onAudioManagerPlaybackStarted(track: Track) : void {\n    this._trigger('track-playback-started', track);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/channel/Player.ts","export abstract class Base {\n  private __events: Object = {};\n\n\n  /**\n   * Adds given callback for given event name.\n   */\n  public on(eventName: string, callback) : Base {\n    if(this.__events.hasOwnProperty(eventName)) {\n      if(this.__events[eventName].indexOf(callback) === -1) {\n        this.__events[eventName].push(callback);\n      } else {\n        throw new Error(`Trying to addd twice the same callback for event \"${eventName}\"`);\n      }\n    } else {\n      this.__events[eventName] = [callback];\n    }\n\n    return this;\n  }\n\n\n  /**\n   * Removes given callback for given event name.\n   */\n  public off(eventName: string, callback) : Base {\n    if(this.__events.hasOwnProperty(eventName)) {\n      const index = this.__events[eventName].indexOf(callback);\n      if(index !== -1) {\n        this.__events[eventName].splice(index, 1);\n      } else {\n        throw new Error(`Trying to remove non-existent callback for event \"${eventName}\"`);\n      }\n    }\n\n    return this;\n  }\n\n\n  /**\n   * Removes all callbacks for given event name.\n   *\n   * If given event name is undefined, removes all callbacks for all events.\n   */\n  public offAll(eventName?: string) : Base {\n    if(eventName) {\n      if(this.__events.hasOwnProperty(eventName)) {\n        delete this.__events[eventName];\n      }\n    } else {\n      this.__events = {};\n    }\n\n    return this;\n  }\n\n\n  protected _trigger(eventName, ...args: any[]) : Base {\n    this.debug(`Event: ${eventName} (${JSON.stringify(args)})`);\n\n    if(this.__events.hasOwnProperty(eventName)) {\n      for(let callback of this.__events[eventName]) {\n        callback.apply(this, args);\n      }\n    }\n\n    return this;\n  }\n\n\n  protected abstract _loggerTag() : string;\n\n\n  protected warn(message: string) : void {\n    console.warn(`[${new Date().toISOString()} RadioKit.Toolkit.Playback ${this._loggerTag()}] ${message}`);\n  }\n\n\n  protected info(message: string) : void {\n    console.info(`[${new Date().toISOString()} RadioKit.Toolkit.Playback ${this._loggerTag()}] ${message}`);\n  }\n\n\n  protected debug(message: string) : void {\n    console.debug(`[${new Date().toISOString()} RadioKit.Toolkit.Playback ${this._loggerTag()}] ${message}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/Base.ts","import { Base } from '../Base';\n\n\n/**\n * This class creates a clock that is synchronized to RadioKit's servers.\n *\n * Use it instead of relying on browser's clock.\n *\n * Do not instantiate it directly, use provided factory makeAsyncForSure() instead.\n *\n * TODO:\n *\n * - handle super corner case when someone changes clock setting during runtime\n */\nexport class SyncClock extends Base {\n  private __offset: number;\n\n\n  /**\n   * Returns promise that builds new clock that is synchronized to the server.\n   */\n  public static makeAsync() : Promise<SyncClock> {\n    const promise = new Promise<SyncClock>((resolve: any, reject: any) => {\n      const xhr = new XMLHttpRequest();\n\n      xhr.open('OPTIONS', 'https://time.radiokitapp.org/api/time/v1.0/now', true);\n      xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n      xhr.timeout = 5000;  // ms\n\n      xhr.onerror = function(e) {\n        reject(new Error(`Unable to synchronize clock: Network error (${xhr.status})`));\n      }\n\n      xhr.onabort = function(e) {\n        reject(new Error(`Unable to synchronize clock: Aborted`));\n      }\n\n      xhr.ontimeout = function(e) {\n        reject(new Error(`Unable to synchronize clock: Timeout`));\n      }\n\n      // TODO include request duration while computing offset\n      xhr.onreadystatechange = function() {\n        if(xhr.readyState === 4) {\n          if(xhr.status === 200) {\n            resolve(new SyncClock(Date.parse(JSON.parse(xhr.responseText).utc_time)));\n\n          } else {\n            reject(new Error(`Unable to synchronize clock: Unexpected response (status = ${xhr.status})`));\n          }\n        }\n      };\n\n      xhr.send();\n    });\n\n\n    return promise;\n  }\n\n\n  /**\n   * Constructs new SyncClock clock.\n   *\n   * Passed serverDate argument is a RadioKit server time as UNIX timestamp.\n   *\n   * Do not use this constructor directly, use SyncClock.makeAsync() factory instead.\n   */\n  constructor(serverDate: number) {\n    super();\n    this.__offset = serverDate - Date.now(); // in milliseconds\n\n    this.debug(`Synchronized clock: offset = ${this.__offset} ms`);\n  }\n\n\n  public nowAsTimestamp() : number {\n    return Date.now() + this.__offset;\n  }\n\n\n  protected _loggerTag() : string {\n    return this['constructor']['name'];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/clock/SyncClock.ts","import { SyncClock } from '../clock/SyncClock';\nimport { Track } from './Track';\nimport { Playlist } from './Playlist';\n\n\n/**\n * This class allows to fetch a Playlist of tracks that are schedule for\n * current time plus small margin.\n */\nexport class PlaylistFetcher {\n  private __clock: SyncClock;\n  private __channelId: string;\n  private __accessToken: string;\n\n\n  constructor(accessToken: string, channelId: string, clock: SyncClock) {\n    this.__clock = clock;\n    this.__channelId = channelId;\n    this.__accessToken = accessToken;\n  }\n\n\n  /**\n   * Asynchronously fetches and creates a Playlist.\n   */\n  public fetchAsync() : Promise<Playlist> {\n    const promise = new Promise<Playlist>((resolve: any, reject: any) => {\n      const now = this.__clock.nowAsTimestamp();\n      const xhr = new XMLHttpRequest();\n\n      const url = 'https://plumber.radiokitapp.org/api/rest/v1.0/media/input/file/radiokit/vault' +\n        '?a[]=id' +\n        '&a[]=name' +\n        '&a[]=file' +\n        '&a[]=cue_in_at' +\n        '&a[]=cue_out_at' +\n        '&a[]=cue_offset' +\n        '&a[]=fade_in_at' +\n        '&a[]=fade_out_at' +\n        '&s[]=cue%20' + encodeURIComponent(new Date(now).toISOString()) + '%2020%20600' + // seek 20 seconds back, 600 seconds forward\n        '&c[references][]=deq%20broadcast_channel_id%20' + encodeURIComponent(this.__channelId) +\n        '&o[]=cue_in_at%20asc';\n\n\n      xhr.open('GET', url, true);\n      xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n      xhr.setRequestHeader('Authorization', `Bearer ${this.__accessToken}`);\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.timeout = 15000;  // ms\n\n      xhr.onerror = function(e) {\n        reject(new Error(`Unable to fetch playlist: Network error (${xhr.status})`));\n      }\n\n      xhr.onabort = function(e) {\n        reject(new Error(`Unable to fetch playlist: Aborted`));\n      }\n\n      xhr.ontimeout = function(e) {\n        reject(new Error(`Unable to fetch playlist: Timeout`));\n      }\n\n      xhr.onreadystatechange = () => {\n        if(xhr.readyState === 4) {\n          if(xhr.status === 200) {\n            const responseAsJson = JSON.parse(xhr.responseText);\n            resolve(Playlist.makeFromJson(this.__accessToken, responseAsJson[\"data\"]));\n\n          } else {\n            reject(new Error(`Unable to fetch playlist: Unexpected response (status = ${xhr.status})`));\n          }\n        }\n      };\n\n      xhr.send();\n    });\n\n    return promise;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/channel/PlaylistFetcher.ts","import { SyncClock } from '../clock/SyncClock';\nimport { Track } from './Track';\n\n\n/**\n * This class represents a playlist of files to be played currently or\n * in a short time span on a given channel.\n */\nexport class Playlist {\n  private __tracks : Object;\n\n\n  /**\n   * Factory that creates a playlist out of JSON data in the API format.\n   */\n  public static makeFromJson(accessToken: string, data: Array<Object>) : Playlist {\n    let tracks : Object = {};\n\n    for(let record of data) {\n      let id          : string       = record['id'];\n      let fileId      : string       = record['file'];\n      let cueInAt     : Date         = new Date(record['cue_in_at']);\n      let cueOutAt    : Date         = new Date(record['cue_out_at']);\n      let cueOffset   : number       = record['cue_offset'];\n      let fadeInAt    : Date | null  = record['fade_in_at'] !== null ? new Date(record['fade_in_at']) : null;\n      let fadeOutAt   : Date | null  = record['fade_out_at'] !== null ? new Date(record['fade_out_at']) : null;\n\n      let track = new Track(accessToken, id, fileId, cueInAt, cueOutAt, cueOffset, fadeInAt, fadeOutAt);\n      tracks[id] = track;\n    }\n\n    return new Playlist(tracks);\n  }\n\n\n  constructor(tracks: Object) {\n    this.__tracks = tracks;\n  }\n\n\n  public getTracks() : Object {\n    return this.__tracks;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/channel/Playlist.ts","import { Base } from '../Base';\nimport { TrackInfo } from './TrackInfo';\nimport { SyncClock } from '../clock/SyncClock';\n\n\nexport class Track extends Base {\n  private __id: string;\n  private __fileId: string;\n  private __cueOffset: number;\n  private __cueInAt: Date;\n  private __cueOutAt: Date;\n  private __fadeInAt?: Date;\n  private __fadeOutAt?: Date;\n  private __accessToken: string;\n\n\n  constructor(accessToken: string, id: string, fileId: string, cueInAt: Date, cueOutAt: Date, cueOffset: number, fadeInAt?: Date, fadeOutAt?: Date) {\n    super();\n\n    this.__accessToken = accessToken;\n    this.__id = id;\n    this.__fileId = fileId;\n    this.__cueInAt = cueInAt;\n    this.__cueOutAt = cueOutAt;\n    this.__cueOffset = cueOffset;\n    this.__fadeInAt = fadeInAt;\n    this.__fadeOutAt = fadeOutAt;\n  }\n\n\n  public getId() : string {\n    return this.__id;\n  }\n\n\n  public getFileId() : string {\n    return this.__fileId;\n  }\n\n\n  public getCueInAt() : Date {\n    return this.__cueInAt;\n  }\n\n\n  public getCueOutAt() : Date {\n    return this.__cueOutAt;\n  }\n\n\n  public getFadeInAt() : Date {\n    return this.__fadeInAt;\n  }\n\n\n  public getFadeOutAt() : Date {\n    return this.__fadeOutAt;\n  }\n\n\n  public getCueOffset() : number {\n    return this.__cueOffset;\n  }\n\n\n  public getInfoAsync() : Promise<TrackInfo> {\n    const promise = new Promise<TrackInfo>((resolve: any, reject: any) => {\n      const xhr = new XMLHttpRequest();\n\n      const url = 'https://vault.radiokitapp.org/api/rest/v1.0/data/record/file' +\n        '?a[]=id' +\n        '&a[]=name' +\n        '&a[]=stage' +\n        '&a[]=references' +\n        '&a[]=extra' +\n        '&a[]=public_url' +\n\n        '&a[]=affiliate_schemas.id' +\n        '&a[]=affiliate_schemas.name' +\n        '&a[]=affiliate_schemas.key' +\n        '&a[]=affiliate_schemas.kind' +\n\n        '&a[]=affiliate_items.id' +\n        '&a[]=affiliate_items.affiliate_schema_id' +\n        '&a[]=affiliate_items.affiliate_metadata' +\n\n        '&a[]=metadata_schemas.id' +\n        '&a[]=metadata_schemas.name' +\n        '&a[]=metadata_schemas.key' +\n        '&a[]=metadata_schemas.kind' +\n\n        '&a[]=metadata_items.id' +\n        '&a[]=metadata_items.metadata_schema_id' +\n        '&a[]=metadata_items.metadata_schema_id' +\n        '&a[]=metadata_items.value_string' +\n        '&a[]=metadata_items.value_db' +\n        '&a[]=metadata_items.value_text' +\n        '&a[]=metadata_items.value_float' +\n        '&a[]=metadata_items.value_integer' +\n        '&a[]=metadata_items.value_duration' +\n        '&a[]=metadata_items.value_date' +\n        '&a[]=metadata_items.value_datetime' +\n        '&a[]=metadata_items.value_time' +\n        '&a[]=metadata_items.value_file' +\n        '&a[]=metadata_items.value_image' +\n        '&a[]=metadata_items.value_url' +\n\n        '&j[]=metadata_schemas' +\n        '&j[]=metadata_items' +\n        '&j[]=affiliate_schemas' +\n        '&j[]=affiliate_items' +\n\n        '&c[id][]=eq%20' + encodeURIComponent(this.__fileId);\n\n      xhr.open('GET', url, true);\n      xhr.setRequestHeader('Authorization', `Bearer ${this.__accessToken}`);\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.timeout = 15000;  // ms\n\n      xhr.onerror = function(e) {\n        reject(new Error(`Unable to fetch playlist: Network error (${xhr.status})`));\n      }\n\n      xhr.onabort = function(e) {\n        reject(new Error(`Unable to fetch playlist: Aborted`));\n      }\n\n      xhr.ontimeout = function(e) {\n        reject(new Error(`Unable to fetch playlist: Timeout`));\n      }\n\n      xhr.onreadystatechange = () => {\n        if(xhr.readyState === 4) {\n          if(xhr.status === 200) {\n            const responseAsJson = JSON.parse(xhr.responseText);\n            if(responseAsJson[\"data\"].length === 1) {\n              resolve(TrackInfo.makeFromJson(responseAsJson[\"data\"][0]));\n            } else {\n              reject(new Error(`Unable to fetch track info: Record not found`));\n            }\n\n          } else {\n            reject(new Error(`Unable to fetch track info: Unexpected response (status = ${xhr.status})`));\n          }\n        }\n      };\n\n      xhr.send();\n    });\n\n    return promise;\n  }\n\n\n  protected _loggerTag() : string {\n    return `${this['constructor']['name']} ${this.__id}`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/channel/Track.ts","export class TrackInfo {\n  private __name: string;\n  private __metadata: Object;\n  private __affiliates: Object;\n\n\n  /**\n   * Factory that creates a track info object out of JSON data in the API format.\n   */\n  public static makeFromJson(data: Object) : TrackInfo {\n    const name = data['name'];\n    const metadata = {};\n    const affiliates = {};\n\n    // Convert list of schemas into objects for faster matches\n    const metadataSchemas = {};\n    for(let metadataSchema of data['metadata_schemas']) {\n      metadataSchemas[metadataSchema['id']] = metadataSchema;\n    }\n\n    const affiliateSchemas = {};\n    for(let affiliateSchema of data['affiliate_schemas']) {\n      affiliateSchemas[affiliateSchema['id']] = affiliateSchema;\n    }\n\n    // Map items into objects\n    for(let metadataItem of data['metadata_items']) {\n      let key = metadataSchemas[metadataItem['metadata_schema_id']].key;\n      let kind = metadataSchemas[metadataItem['metadata_schema_id']].kind;\n      let value = metadataItem[`value_${kind}`];\n\n      metadata[key] = value;\n    }\n\n    for(let affiliateItem of data['affiliate_items']) {\n      let key = affiliateSchemas[affiliateItem['affiliate_schema_id']].key;\n      let value = affiliateItem['affiliate_metadata'];\n\n      affiliates[key] = value;\n    }\n\n    return new TrackInfo(name, metadata, affiliates);\n  }\n\n\n  constructor(name: string, metadata: Object, affiliates: Object) {\n    this.__name = name;\n    this.__metadata = metadata;\n    this.__affiliates = affiliates;\n  }\n\n\n  public getName() : string {\n    return this.__name;\n  }\n\n\n  public getMetadata() : Object {\n    return this.__metadata;\n  }\n\n\n  public getAffiliates() : Object {\n    return this.__affiliates;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/channel/TrackInfo.ts","import { Factory } from './Factory';\nimport { IAudioPlayer } from './IAudioPlayer';\nimport { Playlist } from '../channel/Playlist';\nimport { Track } from '../channel/Track';\nimport { SyncClock } from '../clock/SyncClock';\nimport { Base } from '../Base';\n\n/**\n * This class contains audio manager that can convert playlist into\n * list of players that can actually play given tracks.\n *\n * It keeps their state and allows to update them once new playlist\n * is available.\n *\n * It emits the following events:\n *\n * - playback-started (arg1: track) - when playback starts\n * - position (arg1: track, arg1: position in ms, arg2: duration in ms) -\n *   when the position is updated for the last track for which playback has started\n */\nexport class AudioManager extends Base {\n  private __audioPlayers:   Object = {};\n  private __volume:         number = 1.0;\n  private __currentTrack?:  Track;\n\n\n  /**\n   * Updates list of audio players to match given playlist.\n   *\n   * It performs diff on list of existing players and new playlist, so it\n   * only adds new tracks, removes old ones but do not touch these that\n   * are supposed to be currently playing.\n   */\n  public update(playlist: Playlist, clock: SyncClock) : void {\n    const tracks = playlist.getTracks();\n\n    // Collect list of existing and new track IDs\n    const existingIds = Object.keys(this.__audioPlayers);\n    const newIds = Object.keys(tracks);\n\n\n    // Make diff\n    const tracksToAdd = this.__diff(tracks, this.__audioPlayers);\n    const tracksToRemove = this.__diff(this.__audioPlayers, tracks);\n\n    for(let id in tracksToAdd) {\n      this.debug(`Adding track: ID = ${id}`);\n      this.__audioPlayers[id] = Factory.makeFromTrack(tracks[id], clock);\n      this.__audioPlayers[id].on('playback-started', this.__onAudioPlayerPlaybackStarted.bind(this));\n      this.__audioPlayers[id].on('position', this.__onAudioPlayerPosition.bind(this));\n      this.__audioPlayers[id].start();\n    }\n\n    for(let id in tracksToRemove) {\n      this.debug(`Removing track: ID = ${id}`);\n      this.__removeAudioPlayer(id);\n    }\n  }\n\n\n  /**\n   * Stops all playback and removes associated audio players.\n   */\n  public cleanup() : void {\n    for(let id in this.__audioPlayers) {\n      this.__removeAudioPlayer(id);\n    }\n  }\n\n\n  /**\n   * Sets volume of all current and future audio players.\n   */\n  public setVolume(volume: number) : AudioManager {\n    if(volume < 0.0 || volume > 1.0) {\n      throw new Error('Volume out of range');\n    }\n\n    this.__volume = volume;\n\n    for(let id in this.__audioPlayers) {\n      this.__audioPlayers[id].setVolume(volume);\n    }\n\n    return this;\n  }\n\n\n  protected _loggerTag() : string {\n    return `${this['constructor']['name']}`;\n  }\n\n\n  private __removeAudioPlayer(id: string) {\n    // If we remove player for current track, remove the reference\n    // to avoid memory leaks.\n    if(this.__currentTrack === this.__audioPlayers[id].getTrack()) {\n      this.__currentTrack = undefined;\n    }\n\n    // Detach all event handlers to avoid memory leaks.\n    this.__audioPlayers[id].offAll();\n\n    // Ensure that player is stopped before we remove it to avoid memory leaks.\n    this.__audioPlayers[id].stop();\n\n    // Remove the player\n    delete this.__audioPlayers[id];\n  }\n\n\n  private __diff(object1 : Object, object2 : Object) : Object {\n    const result = {};\n\n    const array1 = Object.keys(object1);\n    const array2 = Object.keys(object2);\n\n    for(let item of array1) {\n      if(array2.indexOf(item) === -1) {\n        result[item] = object1[item];\n      }\n    }\n\n    return result;\n  }\n\n\n  private __onAudioPlayerPlaybackStarted(track: Track) : void {\n    this.__currentTrack = track;\n    this._trigger('playback-started', track);\n  }\n\n\n  private __onAudioPlayerPosition(track: Track, position: number, duration: number) : void {\n    if(track === this.__currentTrack) {\n      this._trigger('position', track, position, duration);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/AudioManager.ts","import { IAudioPlayer } from './IAudioPlayer';\nimport { HTMLPlayer } from './HTMLPlayer';\nimport { Track } from '../channel/Track';\nimport { SyncClock } from '../clock/SyncClock';\n\n\n/**\n * This class implements factory pattern for creating players that utilize\n * the most of browser capabilities.\n */\nexport class Factory {\n  /**\n   * Instantiates an audio player for given track.\n   */\n  public static makeFromTrack(track: Track, clock: SyncClock) : IAudioPlayer {\n    return new HTMLPlayer(track, clock);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/Factory.ts","import { IAudioPlayer } from './IAudioPlayer';\nimport { Track } from '../channel/Track';\nimport { SyncClock } from '../clock/SyncClock';\nimport { Base } from '../Base';\n\n\n/**\n * This class wraps HTML5 <audio> tag into a player that is capable of playing\n * sound from a given source at right time.\n *\n * Do not instantiate this directly, use Factory.make instead.\n *\n * It emits the following events:\n *\n * - playback-started (arg1: track) - when playback starts\n * - position (arg1: track, arg1: position in ms, arg2: duration in ms) -\n *   when the position is updated\n */\nexport class HTMLPlayer extends Base implements IAudioPlayer {\n  private __track:              Track;\n  private __clock:              SyncClock;\n  private __audio:              HTMLAudioElement;\n  private __started:            boolean = false;\n  private __cueInTimeoutId:     number = 0;\n  private __restartTimeoutId:   number = 0;\n  private __positionIntervalId: number = 0;\n  private __volume:             number = 1.0;\n\n\n  constructor(track: Track, clock: SyncClock) {\n    super();\n\n    this.__track = track;\n    this.__clock = clock;\n  }\n\n\n  /**\n   * Starts the player.\n   *\n   * It will try to play given track on time defined by it's cue in point\n   * as long as it does not reach EOS or stop() is being called.\n   *\n   * It will restart the playback in case of any issues and seek to\n   * the appropriate position.\n   *\n   * TODO: Support fades\n   * TODO: Support cue out\n   */\n  public start() : HTMLPlayer {\n    if(!this.__started) {\n      this.debug('Starting');\n      this.__started = true;\n\n      this.__preparePlayback();\n\n    } else {\n      throw new Error('Attempt to start HTML Player that is already started');\n    }\n\n    return this;\n  }\n\n\n  /**\n   * Stops the player.\n   */\n  public stop() : HTMLPlayer {\n    if(this.__started) {\n      this.debug('Stopping');\n      this.__stopPlayback();\n\n      this.__started = false;\n\n    } else {\n      throw new Error('Attempt to stop HTML Player that is not started');\n    }\n\n    return this;\n  }\n\n\n  public setVolume(volume: number) : HTMLPlayer {\n    if(volume < 0.0 || volume > 1.0) {\n      throw new Error('Volume out of range');\n    }\n\n    this.__volume = volume;\n\n    if(this.__audio) {\n      this.__audio.volume = volume;\n    }\n\n    return this;\n  }\n\n\n  public getTrack() : Track {\n    return this.__track;\n  }\n\n\n  protected _loggerTag() : string {\n    return `${this['constructor']['name']} ${this.__track.getId()}`;\n  }\n\n\n  private __onAudioLoadedMetadata(e) : void {\n    this.debug('Loaded metadata');\n    this.__audio.onloadedmetadata = undefined;\n\n    const now = this.__clock.nowAsTimestamp();\n    const cueInAt = this.__track.getCueInAt().valueOf();\n    const cueOutAt = this.__track.getCueOutAt().valueOf();\n\n    if(now >= cueOutAt) {\n      // We are after the sound is supposed to play, do nothing.\n      this.debug('Track is obsolete');\n\n    } else {\n      // We are before the sound is supposed to play\n      if(now < cueInAt) {\n        // We are too early, wait to start\n        const timeout = cueInAt - now;\n        this.debug(`Waiting for ${timeout} ms`);\n        this.__cueInTimeoutId = setTimeout(this.__onCueInTimeout.bind(this), timeout);\n\n      } else if(now > cueInAt) {\n        // We are too late, seek\n        const position = now - cueInAt;\n        this.debug(`Seeking to ${position} ms`);\n\n        this.__audio.currentTime = position / 1000.0;\n        this.__startPlayback();\n\n      } else {\n        // We are right on time, just play\n        this.__startPlayback();\n      }\n    }\n  }\n\n\n  private __onAudioError(e) : void {\n    this.warn('Error');\n    this.__stopPlayback();\n    this.__scheduleRestart();\n  }\n\n\n  private __onAudioEnded(e) : void {\n    this.debug('EOS');\n    this.__stopPlayback();\n  }\n\n\n  private __onAudioWaiting(e) : void {\n    this.warn('Waiting');\n  }\n\n\n  private __onAudioStalled(e) : void {\n    this.warn('Stalled');\n  }\n\n\n  private __onAudioSuspended(e) : void {\n    this.warn('Suspended');\n  }\n\n\n  private __onCueInTimeout() : void {\n    this.debug('Cue In timeout has passed');\n    this.__cueInTimeoutId = 0;\n    this.__preparePlayback();\n  }\n\n\n  private __preparePlayback() : void {\n    this.debug('Preparing playback');\n    this.__audio = new Audio();\n    this.__audio.volume = this.__volume;\n    this.__audio.onloadedmetadata = this.__onAudioLoadedMetadata.bind(this);\n    this.__audio.onerror = this.__onAudioError.bind(this);\n    this.__audio.onended = this.__onAudioEnded.bind(this);\n\n    if(this.__audio.canPlayType('application/ogg; codecs=opus')) {\n      this.__audio.src = `https://essence.radiokitapp.org/api/cdn/v1.0/vault/file/${this.__track.getFileId()}/variant/webbrowser-opus`;\n\n    } else if(this.__audio.canPlayType('audio/mpeg')) {\n      this.__audio.src = `https://essence.radiokitapp.org/api/cdn/v1.0/vault/file/${this.__track.getFileId()}/variant/webbrowser-mp3`;\n\n    } else {\n      throw new Error('Browser supports none of formats server can send.');\n    }\n  }\n\n\n  private __startPlayback() : void {\n    this.debug('Starting playback');\n    this.__positionIntervalId = setInterval(this.__onPositionInterval.bind(this), 250);\n\n    this.__audio.onwaiting = this.__onAudioWaiting.bind(this);\n    this.__audio.onstalled = this.__onAudioStalled.bind(this);\n    this.__audio.onsuspend = this.__onAudioSuspended.bind(this);\n    this.__audio.play();\n\n    this._trigger('playback-started', this.__track);\n  }\n\n\n  private __stopPlayback() : void {\n    this.debug('Stopping playback');\n    if(this.__audio) {\n      this.__audio.onloadedmetadata = undefined;\n      this.__audio.onerror = undefined;\n      this.__audio.onended = undefined;\n      this.__audio.onwaiting = undefined;\n      this.__audio.onstalled = undefined;\n      this.__audio.onsuspend = undefined;\n      this.__audio.pause();\n      delete this.__audio;\n      this.__audio = undefined;\n    }\n\n    if(this.__cueInTimeoutId !== 0) {\n      clearTimeout(this.__cueInTimeoutId);\n      this.__cueInTimeoutId = 0;\n    }\n\n    if(this.__restartTimeoutId !== 0) {\n      clearTimeout(this.__restartTimeoutId);\n      this.__restartTimeoutId = 0;\n    }\n\n    if(this.__positionIntervalId !== 0) {\n      clearInterval(this.__positionIntervalId);\n      this.__positionIntervalId = 0;\n    }\n  }\n\n\n  private __scheduleRestart() : void {\n    if(this.__started) {\n      const timeout = 500 + Math.round(Math.random() * 250);\n      this.debug(`Scheduling restart in ${timeout} ms`);\n      this.__restartTimeoutId = setTimeout(() => {\n        this.__restartTimeoutId = 0;\n        this.__preparePlayback();\n      }, timeout);\n    }\n  }\n\n\n  private __onPositionInterval() {\n    const position = Math.round(this.__audio.currentTime * 1000);\n    const cueInAt = this.__track.getCueInAt().valueOf();\n    const cueOutAt = this.__track.getCueOutAt().valueOf();\n    const duration = cueOutAt - cueInAt;\n\n    this._trigger('position', this.__track, position, duration);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/audio/HTMLPlayer.ts"],"sourceRoot":""}