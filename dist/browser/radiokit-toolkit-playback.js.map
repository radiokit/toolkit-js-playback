{"version":3,"sources":["webpack:///webpack/bootstrap e679c8c2b03a2fae7d4b","webpack:///./lib/index.js","webpack:///(webpack)/buildin/module.js","webpack:///./lib/player/Channel.js","webpack:///./lib/Base.js","webpack:///./lib/clock/SyncClock.js","webpack:///./lib/channel/Playlist.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACTA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACpBA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAgF;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,EAAC;AACD","file":"radiokit-toolkit-playback.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e679c8c2b03a2fae7d4b","\"use strict\";\nvar Channel_1 = require(\"./player/Channel\");\nvar e = {\n    Player: {\n        Channel: Channel_1.Channel,\n    }\n};\nmodule.e = e;\nif (typeof (window) !== \"undefined\") {\n    window['RadioKitToolkitPlayback'] = e;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/index.js\n// module id = 0\n// module chunks = 0","module.exports = function(module) {\n\tif(!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tmodule.children = [];\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/module.js\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar SyncClock_1 = require(\"../clock/SyncClock\");\nvar Playlist_1 = require(\"../channel/Playlist\");\nvar Channel = (function (_super) {\n    __extends(Channel, _super);\n    function Channel(channelId, accessToken) {\n        var _this = _super.call(this) || this;\n        _this.__fetchTimeoutId = 0;\n        _this.__channelId = channelId;\n        _this.__accessToken = accessToken;\n        return _this;\n    }\n    Channel.prototype.start = function () {\n        var _this = this;\n        this.info(\"Starting: Synchronizing clock...\");\n        var promise = new Promise(function (resolve, reject) {\n            SyncClock_1.SyncClock.makeAsync()\n                .catch(function (error) {\n                _this.warn(\"Failed to start: Unable to sync clock (\" + error.message + \")\");\n                reject(new Error(\"Unable to sync clock (\" + error.message + \")\"));\n            }).then(function (clock) {\n                _this.debug(\"Starting: Synchronized clock\");\n                _this.__clock = clock;\n                _this.__fetchTimeoutId = setTimeout(_this.__onFetchTimeout, 1);\n                resolve(_this);\n            });\n        });\n        return promise;\n    };\n    Channel.prototype.fetch = function () {\n        Playlist_1.Playlist.fetchAsync(this.__channelId, this.__accessToken, this.__clock)\n            .catch(function (error) {\n            throw error;\n        })\n            .then(function (playlist) {\n            return playlist;\n        });\n    };\n    Channel.prototype._loggerTag = function () {\n        return this['constructor']['name'] + \" \" + this.__channelId;\n    };\n    Channel.prototype.__onFetchTimeout = function () {\n        this.__fetchTimeoutId = 0;\n    };\n    return Channel;\n}(Base_1.Base));\nexports.Channel = Channel;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/player/Channel.js\n// module id = 2\n// module chunks = 0","\"use strict\";\nvar Base = (function () {\n    function Base() {\n        this.__events = {};\n    }\n    Base.prototype.on = function (eventName, callback) {\n    };\n    Base.prototype.off = function (eventName, callback) {\n    };\n    Base.prototype.warn = function (message) {\n        console.warn(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    Base.prototype.info = function (message) {\n        console.info(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    Base.prototype.debug = function (message) {\n        console.debug(\"[RadioKit.Playback \" + new Date().toISOString() + \" \" + this._loggerTag() + \"] \" + message);\n    };\n    return Base;\n}());\nexports.Base = Base;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/Base.js\n// module id = 3\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Base_1 = require(\"../Base\");\nvar SyncClock = (function (_super) {\n    __extends(SyncClock, _super);\n    function SyncClock(serverDate) {\n        var _this = _super.call(this) || this;\n        _this.__offset = serverDate - Date.now();\n        _this.debug(\"Constructed sync clock (offset = \" + _this.__offset + \" ms}\");\n        return _this;\n    }\n    SyncClock.makeAsync = function () {\n        var promise = new Promise(function (resolve, reject) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('OPTIONS', 'https://time.radiokitapp.org/api/time/v1.0/now', true);\n            xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n            xhr.timeout = 5000;\n            xhr.onerror = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Network error (\" + xhr.status + \")\"));\n            };\n            xhr.onabort = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Aborted\"));\n            };\n            xhr.ontimeout = function (e) {\n                reject(new Error(\"Unable to synchronize clock: Timeout\"));\n            };\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(new SyncClock(Date.parse(JSON.parse(xhr.responseText).utc_time)));\n                    }\n                    else {\n                        reject(new Error(\"Unable to synchronize clock: Unexpected response (status = \" + xhr.status + \")\"));\n                    }\n                }\n            };\n            xhr.send();\n        });\n        return promise;\n    };\n    SyncClock.prototype.nowAsTimestamp = function () {\n        return Date.now() + this.__offset;\n    };\n    SyncClock.prototype._loggerTag = function () {\n        return this['constructor']['name'];\n    };\n    return SyncClock;\n}(Base_1.Base));\nexports.SyncClock = SyncClock;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/clock/SyncClock.js\n// module id = 4\n// module chunks = 0","\"use strict\";\nvar Playlist = (function () {\n    function Playlist() {\n    }\n    Playlist.fetchAsync = function (channelId, accessToken, clock) {\n        var promise = new Promise(function (resolve, reject) {\n            var now = clock.nowAsTimestamp();\n            var xhr = new XMLHttpRequest();\n            var url = 'https://plumber.radiokitapp.org/api/rest/v1.0/media/input/file/radiokit/vault?' +\n                'a[]=id' +\n                '&a[]=name' +\n                '&a[]=file' +\n                '&a[]=start_at' +\n                '&a[]=stop_at' +\n                '&a[]=cue_in_at' +\n                '&a[]=cue_out_at' +\n                '&a[]=cue_offset' +\n                '&a[]=fade_in_at' +\n                '&a[]=fade_out_at' +\n                '&s[]=cue%20' + new Date(now).toISOString() + '%2020%20600' +\n                '&o[]=cue_in_at%20asc';\n            xhr.open('GET', url, true);\n            xhr.setRequestHeader('Cache-Control', 'no-cache, must-revalidate');\n            xhr.setRequestHeader('Authorization', \"Bearer \" + accessToken);\n            xhr.timeout = 15000;\n            xhr.onerror = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Network error (\" + xhr.status + \")\"));\n            };\n            xhr.onabort = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Aborted\"));\n            };\n            xhr.ontimeout = function (e) {\n                reject(new Error(\"Unable to fetch playlist: Timeout\"));\n            };\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(new Playlist());\n                    }\n                    else {\n                        reject(new Error(\"Unable to fetch playlist: Unexpected response (status = \" + xhr.status + \")\"));\n                    }\n                }\n            };\n            xhr.send();\n        });\n        return promise;\n    };\n    return Playlist;\n}());\nexports.Playlist = Playlist;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/channel/Playlist.js\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}